[2024-08-12 10:40:41,993][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:40:52,384][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:40:52,679][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:40:52,838][__main__][INFO] - in loading graph structure
[2024-08-12 10:44:18,333][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:44:28,796][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:44:29,159][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:44:29,316][__main__][INFO] - in loading graph structure
[2024-08-12 10:47:57,953][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:48:08,561][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:48:09,002][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:48:09,184][__main__][INFO] - in loading graph structure
[2024-08-12 10:50:12,376][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:50:22,976][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:50:23,440][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:50:23,630][__main__][INFO] - in loading graph structure
[2024-08-12 10:51:25,769][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:51:37,620][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:51:38,099][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:51:38,293][__main__][INFO] - in loading graph structure
[2024-08-12 10:52:37,622][__main__][INFO] - Building faiss index...
[2024-08-12 10:52:47,773][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from index_data/folio/index_dataset.json, size 1001
[2024-08-12 10:52:56,147][__main__][INFO] - Saving faiss index to output/folio/folio/llama3-8b/CEG/index, size 1001
[2024-08-12 10:52:56,791][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 10:52:59,720][__main__][INFO] - in graphsim rerank
[2024-08-12 10:54:23,073][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 10:54:33,724][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 10:54:34,191][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 10:54:34,374][__main__][INFO] - in loading graph structure
[2024-08-12 10:54:55,752][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 10:54:56,846][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 10:54:59,801][__main__][INFO] - in graphsim rerank
[2024-08-12 11:36:02,093][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 11:36:12,669][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 11:36:13,119][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 11:36:13,298][__main__][INFO] - in loading graph structure
[2024-08-12 11:36:35,667][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 11:36:36,727][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 11:36:39,702][__main__][INFO] - in graphsim rerank
[2024-08-12 11:36:41,867][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json
[2024-08-12 11:38:14,667][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 11:38:45,296][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 11:38:45,747][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 11:38:45,941][__main__][INFO] - in loading graph structure
[2024-08-12 11:39:47,598][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 11:39:48,569][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 11:39:51,496][__main__][INFO] - in graphsim rerank
[2024-08-12 11:39:55,609][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-12 15:01:04,916][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 15:01:15,412][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 15:01:15,783][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 15:01:15,983][__main__][INFO] - in loading graph structure
[2024-08-12 15:01:37,658][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 15:01:38,969][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 15:01:42,208][__main__][INFO] - in graphsim rerank
[2024-08-12 15:01:46,356][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-12 19:50:48,436][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 19:50:58,745][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 19:50:59,004][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 19:50:59,127][__main__][INFO] - in loading graph structure
[2024-08-12 19:51:20,371][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 19:51:21,525][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 19:51:24,323][__main__][INFO] - in graphsim rerank
[2024-08-12 19:51:26,005][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-12 20:00:26,804][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 20:00:38,446][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 20:00:38,751][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 20:00:38,908][__main__][INFO] - in loading graph structure
[2024-08-12 20:01:01,188][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 20:01:02,299][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 20:01:05,009][__main__][INFO] - in graphsim rerank
[2024-08-12 20:01:06,509][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-12 22:51:07,858][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-12 22:51:19,505][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-12 22:51:19,802][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-12 22:51:19,960][__main__][INFO] - in loading graph structure
[2024-08-12 22:51:41,074][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-12 22:51:42,184][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-12 22:51:44,867][__main__][INFO] - in graphsim rerank
[2024-08-12 22:51:46,370][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-13 01:47:25,199][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 01:47:36,828][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 01:47:37,121][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-13 01:47:37,271][__main__][INFO] - in loading graph structure
[2024-08-13 01:47:59,391][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 01:48:00,532][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 01:48:03,268][__main__][INFO] - in graphsim rerank
[2024-08-13 01:48:04,157][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json
[2024-08-13 02:19:54,165][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_complex_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 02:21:34,007][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json', 'num_candidates': 50, 'num_ice': 8, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 02:21:44,414][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 02:21:44,796][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from output/folio/vanilla/llama3-8b_cot.json, size 203
[2024-08-13 02:21:45,151][__main__][INFO] - in loading graph structure
[2024-08-13 02:22:06,282][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 02:22:08,033][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 02:22:10,703][__main__][INFO] - in graphsim rerank
[2024-08-13 02:22:11,732][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json
[2024-08-13 02:50:20,582][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 02:50:31,062][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 02:50:31,356][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from output/folio/vanilla/llama3-8b_cot.json, size 203
[2024-08-13 02:50:31,702][__main__][INFO] - in loading graph structure
[2024-08-13 02:50:37,342][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 02:50:53,859][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 02:50:55,788][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 02:50:58,454][__main__][INFO] - in graphsim rerank
[2024-08-13 02:50:59,442][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json
[2024-08-13 02:59:24,181][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 02:59:34,596][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 02:59:34,902][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-13 02:59:35,061][__main__][INFO] - in loading graph structure
[2024-08-13 02:59:50,249][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 02:59:51,368][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 02:59:54,174][__main__][INFO] - in graphsim rerank
[2024-08-13 02:59:55,103][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json
[2024-08-13 10:56:02,121][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 10:56:12,486][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 10:56:12,800][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-13 10:56:12,953][__main__][INFO] - in loading graph structure
[2024-08-13 10:56:35,029][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 10:56:36,101][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 10:56:38,863][__main__][INFO] - in graphsim rerank
[2024-08-13 10:56:39,733][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32.json
[2024-08-13 17:25:41,295][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_field_dq.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 17:25:55,711][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_field_dq.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 17:26:12,283][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 17:26:12,578][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from output/folio/vanilla/llama3-8b_cot.json, size 203
[2024-08-13 17:26:12,918][__main__][INFO] - in loading graph structure
[2024-08-13 17:26:39,492][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 17:26:41,346][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 17:26:44,108][__main__][INFO] - in graphsim rerank
[2024-08-13 17:26:45,797][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_field_dq.json
[2024-08-13 20:51:14,972][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank96_field_dq.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 96, 'dq': False, 'dq_file_path': 'output/folio/vanilla/llama3-8b_cot.json', 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'dq_qa', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 20:51:25,353][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 20:51:25,690][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from output/folio/vanilla/llama3-8b_cot.json, size 203
[2024-08-13 20:51:26,020][__main__][INFO] - in loading graph structure
[2024-08-13 20:51:51,909][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank96.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 96, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 20:52:02,374][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 20:52:02,712][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-13 20:52:02,866][__main__][INFO] - in loading graph structure
[2024-08-13 20:52:25,048][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 20:52:26,128][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 20:52:28,916][__main__][INFO] - in graphsim rerank
[2024-08-13 20:52:31,136][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank96.json
[2024-08-13 23:57:36,301][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 23:57:49,141][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-13 23:57:59,559][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-13 23:57:59,855][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-13 23:58:00,007][__main__][INFO] - in loading graph structure
[2024-08-13 23:58:01,537][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-13 23:58:02,667][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-13 23:58:05,407][__main__][INFO] - in graphsim rerank
[2024-08-14 00:00:45,420][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64.json
[2024-08-14 00:15:57,611][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 5, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 00:16:08,039][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 00:16:08,350][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 00:16:08,507][__main__][INFO] - in loading graph structure
[2024-08-14 00:16:29,546][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 00:16:30,632][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 00:16:33,421][__main__][INFO] - in graphsim rerank
[2024-08-14 00:16:35,534][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl.json
[2024-08-14 02:25:13,738][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank16_wl.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 16, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 02:25:24,150][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 02:25:24,452][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 02:25:24,604][__main__][INFO] - in loading graph structure
[2024-08-14 02:25:46,650][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 02:25:47,682][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 02:25:50,437][__main__][INFO] - in graphsim rerank
[2024-08-14 02:25:51,023][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank16_wl.json
[2024-08-14 02:27:17,020][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_sp.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 32, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 02:27:28,430][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 02:27:28,715][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 02:27:28,866][__main__][INFO] - in loading graph structure
[2024-08-14 02:27:49,810][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 02:27:50,893][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 02:27:53,566][__main__][INFO] - in graphsim rerank
[2024-08-14 02:27:54,310][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank32_sp.json
[2024-08-14 10:50:25,729][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl_niter2.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 2, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 10:50:36,116][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 10:50:36,415][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 10:50:36,565][__main__][INFO] - in loading graph structure
[2024-08-14 10:51:13,781][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl_niter2.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 2, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 10:51:25,216][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 10:51:25,586][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 10:51:25,754][__main__][INFO] - in loading graph structure
[2024-08-14 10:51:46,805][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 10:51:47,980][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 10:51:50,741][__main__][INFO] - in graphsim rerank
[2024-08-14 10:51:51,950][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl_niter2.json
[2024-08-14 11:09:32,213][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl_niter3.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 64, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 11:09:42,606][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 11:09:42,899][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 11:09:43,049][__main__][INFO] - in loading graph structure
[2024-08-14 11:10:04,078][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 11:10:05,152][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 11:10:07,856][__main__][INFO] - in graphsim rerank
[2024-08-14 11:10:09,359][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank64_wl_niter3.json
[2024-08-14 18:48:21,203][__main__][INFO] - {'output_file': 'output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank16_sp.json', 'num_candidates': 50, 'num_ice': 4, 'task_name': 'folio', 'batch_size': 64, 'model_name': 'bert-base-uncased', 'qa_model_name': 'llama3-8b', 'faiss_index': 'output/folio/folio/llama3-8b/CEG/index', 'index_dict': 'output/folio/folio/llama3-8b/CEG/index_dict.pickle', 'pretrained_model_path': 'output/folio/folio/llama3-8b/bert-fix_ctx-shared-bs64/qa_model', 'sb_retriever': False, 'dpp_search': False, 'dpp_topk': 100, 'mode': 'cand_random', 'rerank': True, 'rerank_ice': 16, 'dq': False, 'dq_file_path': None, 'pca': False, 'pca_dc': 256, 'graphsim': True, 'graph_path': 'save_graph/folio', 'n_iter': 3, 'sensim_graphsim': False, 'alpha': 0.5, 'dataset_reader': {'_target_': 'src.dataset_readers.base_dsr.BaseDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'q', 'dataset_split': 'validation', 'dataset_path': './index_data/folio/folio/test.json', 'ds_size': None}, 'index_reader': {'_target_': 'src.dataset_readers.index_dsr.IndexDatasetReader', 'task_name': '${task_name}', 'model_name': '${model_name}', 'field': 'qa', 'dataset_split': None, 'dataset_path': 'index_data/folio/index_dataset.json', 'ds_size': None}, 'model_config': {'_target_': 'src.models.biencoder.BiEncoderConfig', 'q_model_name': '${model_name}', 'ctx_model_name': '${model_name}', 'norm_embed': False, 'scale_factor': 0.1}}
[2024-08-14 18:48:31,645][datasets][INFO] - PyTorch version 2.3.0 available.
[2024-08-14 18:48:31,977][src.dataset_readers.dataset_wrappers.base_dsw][INFO] - Loading dataset from ./index_data/folio/folio/test.json, size 203
[2024-08-14 18:48:32,132][__main__][INFO] - in loading graph structure
[2024-08-14 18:48:53,179][__main__][INFO] - Loading faiss index from output/folio/folio/llama3-8b/CEG/index
[2024-08-14 18:48:54,321][src.utils.misc][INFO] - Parallel running with 8 processes
[2024-08-14 18:48:57,133][__main__][INFO] - in graphsim rerank
[2024-08-14 18:48:57,575][__main__][INFO] - save to output/folio/folio/llama3-8b/CEG/prompt-CEG_rerank16_sp.json
